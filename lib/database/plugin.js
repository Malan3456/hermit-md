const config = require('../../config');
const { DataTypes } = require('sequelize');

const PluginDB = config.DATABASE.define('Plugin', {
    name: {
        type: DataTypes.STRING,
        allowNull: false
    },
    url: {
        type: DataTypes.TEXT,
        allowNull: false
    }
});

async function installPlugin(adres, file) {
    var Plugin = await PluginDB.findAll({
        where: {url: adres}
    });

    if (Plugin.length >= 1) {
        return await Plugin[0].update({ url: adres, name: file });
    } else {
        return await PluginDB.create({ url: adres, name: file });
    }
}

function _0x55c9(n,t){const r=_0x17f6();return(_0x55c9=function(n,t){return r[n-=250]})(n,t)}function _0x2c0d(n,t){const r=_0x55c9,u={LCbgj:function(n,t){return n-t},pomtW:function(n,t){return n+t},lAhSB:function(n,t){return n*t},WHVDk:function(n){return n()},YrSfc:function(n,t,r){return n(t,r)}},e=u[r(307)](_0xe53e);return _0x2c0d=function(n,t){const c=r;return n=u[c(291)](n,u[c(306)](u[c(306)](-4719,3998),u[c(264)](71,15))),e[n]},u[r(296)](_0x2c0d,n,t)}function _0xe53e(){const n=_0x55c9,t={KRtyS:n(329),oHYAF:n(357),YfRnJ:n(356),wcqxq:n(374)+n(295),QsZYZ:n(277),lVsLE:n(265),euqFQ:n(384)+"Aa",xfVQo:n(362),bWyzu:n(289)+"Th",ddGAt:n(259),JYGIN:n(258),BtVhc:n(332)+"F",xqLNr:n(288),IBuFK:n(285)+"X",BPrgK:n(275),MmEqF:n(366),yWQTw:n(270),iaBDr:n(372),gkwrl:n(280)+n(250),WIBSB:n(284),Uodrs:n(251),uClzk:n(353),jdgCI:n(327),xKNtS:n(319),MfnmV:n(375),KJZMW:n(299)+n(354),JgnjM:function(n){return n()}},r=[t[n(316)],t[n(310)],t[n(262)],t[n(335)],t[n(312)],t[n(333)],t[n(340)],t[n(376)],t[n(257)],t[n(267)],t[n(383)],t[n(323)],t[n(381)],t[n(297)],t[n(263)],t[n(325)],t[n(330)],t[n(326)],t[n(360)],t[n(294)],t[n(293)],t[n(255)],t[n(287)],t[n(364)],t[n(369)],t[n(345)]];return _0xe53e=function(){return r},t[n(261)](_0xe53e)}function _0x17f6(){const n=["3MfafKn","BcyaZ","ZMROs","MfnmV","Vbhhr","HSdil","destroy","xofem","38391925Wk","tIkqM","xfVQo","WaKRg","DzzAQ","369347lIfOBd","DdKRb","xqLNr","lXprm","JYGIN","363725BEul","oKJ","28QTllML","UXWas","AgqVN","LYGyh","uClzk","VwofY","bWyzu","ylYmY","push","264123hpeNRg","JgnjM","YfRnJ","BPrgK","lAhSB","4634LGbfdB","eXwmx","ddGAt","4GAelLg","MEYSu","first","iyOwW","ZqNHB","GYpEQ","35NSIqdr","url","yCrjo","dataValues","112024jASlNp","477PuydPf","2157970fAL","lIJnK","hPaFY","exDZf","length","10100DeDSd","497226BwKDzL","jdgCI","create","763397qaVE","EQIIu","LCbgj","ViNWV","Uodrs","WIBSB","IIwO","YrSfc","IBuFK","xwJAW","3304434vIY","FOCav","XRuMG","LblnO","939954ZQIUcs","AsyAG","ZwLFO","pomtW","WHVDk","YNauo","UpmTh","oHYAF","XwpYj","QsZYZ","ForLV","xzCbv","eBVGS","KRtyS","380rijyPH","6297830uWtnLo","findAll","sjwsD","vxeTY","tIshE","BtVhc","BvEMv","MmEqF","iaBDr","3186BDOzYb","gINVq","aVVWq","yWQTw","zZesu","13576FkQhn","lVsLE","cROzg","wcqxq","KJPgW","KpujX","AZhpE","Knfpx","euqFQ","qzsVn","1513740tKJqXs","nglMQ","MDpAo","KJZMW","czYxb","shift","IVSJb","YpTsA","HYMbs","ryfAP","ldEIl","XjuWv","kWc","tLvWl","name","map","mcxfF","BHDZb","gkwrl","ENLUB","Ywvfo","fzGsK","xKNtS","jYIFZ"];return(_0x17f6=function(){return n})()}async function getPlugin(n){const t=_0x55c9,r={KJPgW:function(n,t){return n<t},BHDZb:function(n,t){return n==t},UXWas:function(n,t){return n(t)},LYGyh:function(n,t){return n(t)},XRuMG:function(n,t){return n(t)},VwofY:function(n,t){return n(t)},hPaFY:function(n,t){return n(t)},HYMbs:function(n,t){return n(t)},gINVq:function(n,t){return n(t)},ldEIl:function(n,t){return n(t)},DdKRb:function(n,t){return n(t)},FOCav:function(n,t){return n+t},tLvWl:function(n,t){return n+t},DzzAQ:function(n,t){return n*t},lIJnK:function(n,t){return n*t},czYxb:function(n,t){return n+t},YNauo:function(n,t){return n*t},MDpAo:function(n,t){return n(t)},ENLUB:function(n,t){return n(t)},AgqVN:function(n,t){return n(t)},ZMROs:function(n,t){return n*t},YpTsA:function(n,t){return n*t},BvEMv:function(n,t){return n(t)},ForLV:function(n,t){return n(t)},ryfAP:function(n,t){return n+t}},u=_0x2c0d,e={aVVWq:function(n,t){return r[_0x55c9(336)](n,t)},XjuWv:r[t(256)](u,368),Ywvfo:r[t(282)](u,354),ylYmY:function(n,u){return r[t(359)](n,u)},tIkqM:r[t(350)](u,356)};if(n){const c={where:{name:n}},f=await PluginDB[r[t(328)](u,363)](c);return!e[r[t(352)](u,366)](f[r[t(380)](u,359)],r[t(300)](r[t(355)](-5855,r[t(378)](-4286,1)),r[t(281)](1,10142)))&&f[r[t(346)](r[t(346)](r[t(378)](683,11),r[t(308)](-7333,-1)),r[t(308)](571,-26))][r[t(344)](u,344)]}const c=await PluginDB[r[t(361)](u,363)]();if(e[r[t(253)](u,366)](c[r[t(282)](u,359)],r[t(346)](r[t(355)](r[t(368)](21,-177),5124),r[t(349)](-1406,1)))){const n={name:e[r[t(324)](u,361)],url:e[r[t(313)](u,347)]},c=await PluginDB[r[t(253)](u,352)](n);return await c[r[t(328)](u,357)](),!!e[r[t(252)](u,350)](c.id,r[t(351)](r[t(355)](-4369,-3821),8191))&&e[r[t(344)](u,364)]}{let n=[];return c[r[t(253)](u,367)]((e=>{const c=t,f=u,o={name:e[r[c(252)](f,344)][r[c(254)](f,368)],url:e[r[c(301)](f,344)][r[c(254)](f,354)]};n[r[c(252)](f,349)](o)})),n}}!function(n,t){const r=_0x55c9,u=_0x17f6();for(;;)try{if(482891===parseInt(r(260))/1*(-parseInt(r(268))/2)+-parseInt(r(303))/3+parseInt(r(342))/4+parseInt(r(274))/5*(parseInt(r(286))/6)+parseInt(r(318))/7+-parseInt(r(278))/8*(-parseInt(r(279))/9)+-parseInt(r(317))/10*(parseInt(r(379))/11))break;u.push(u.shift())}catch(n){u.push(u.shift())}}(),function(n,t){const r=_0x55c9,u={mcxfF:function(n){return n()},MEYSu:function(n,t){return n+t},eXwmx:function(n,t){return n+t},AZhpE:function(n,t){return n+t},xzCbv:function(n,t){return n+t},Vbhhr:function(n,t){return n+t},tIshE:function(n,t){return n/t},zZesu:function(n,t){return n(t)},sjwsD:function(n,t){return n+t},KpujX:function(n,t){return n*t},iyOwW:function(n,t){return n/t},UpmTh:function(n,t){return n(t)},AsyAG:function(n,t){return n(t)},ZwLFO:function(n,t){return n+t},WaKRg:function(n,t){return n/t},vxeTY:function(n,t){return n(t)},XwpYj:function(n,t){return n+t},GYpEQ:function(n,t){return n*t},EQIIu:function(n,t){return n/t},ZqNHB:function(n,t){return n(t)},xwJAW:function(n,t){return n+t},yCrjo:function(n,t){return n*t},xofem:function(n,t){return n(t)},HSdil:function(n,t){return n+t},eBVGS:function(n,t){return n+t},qzsVn:function(n,t){return n*t},cROzg:function(n,t){return n(t)},lXprm:function(n,t){return n+t},LblnO:function(n,t){return n+t},Knfpx:function(n,t){return n*t},nglMQ:function(n,t){return n*t},exDZf:function(n,t){return n+t},jYIFZ:function(n,t){return n+t},fzGsK:function(n,t){return n/t},BcyaZ:function(n,t){return n===t},ViNWV:r(259),IVSJb:r(347)},e=_0x2c0d,c=u[r(358)](n);for(;;)try{const n=u[r(269)](u[r(266)](u[r(338)](u[r(314)](u[r(269)](u[r(370)](u[r(322)](u[r(331)](parseInt,u[r(331)](e,348)),u[r(320)](u[r(266)](-9301,u[r(337)](57,37)),7193)),u[r(337)](u[r(271)](u[r(309)](parseInt,u[r(304)](e,358)),u[r(269)](u[r(305)](-669,u[r(337)](-2,-1663)),-2655)),u[r(377)](-u[r(321)](parseInt,u[r(321)](e,355)),u[r(266)](u[r(311)](u[r(337)](1,-911),u[r(273)](-1297,-5)),-5571)))),u[r(273)](u[r(322)](u[r(321)](parseInt,u[r(331)](e,360)),u[r(266)](u[r(338)](-4211,3277),938)),u[r(290)](-u[r(304)](parseInt,u[r(272)](e,346)),u[r(269)](u[r(298)](u[r(337)](-1,-983),-4888),u[r(276)](-1955,-2))))),u[r(290)](-u[r(272)](parseInt,u[r(373)](e,365)),u[r(371)](u[r(315)](2420,u[r(337)](-5875,1)),u[r(273)](-3461,-1)))),u[r(337)](u[r(322)](-u[r(331)](parseInt,u[r(309)](e,345)),u[r(338)](u[r(320)](-6056,-4619),10682)),u[r(271)](u[r(321)](parseInt,u[r(331)](e,351)),u[r(298)](u[r(311)](-7292,-4155),u[r(337)](-145,-79))))),u[r(341)](u[r(322)](-u[r(321)](parseInt,u[r(334)](e,362)),u[r(382)](u[r(302)](9082,u[r(339)](-1,7)),u[r(343)](-3,3022))),u[r(377)](u[r(309)](parseInt,u[r(272)](e,353)),u[r(283)](u[r(365)](6400,u[r(276)](-1,-9167)),-15557)))),u[r(363)](u[r(334)](parseInt,u[r(321)](e,369)),u[r(370)](u[r(315)](7241,u[r(343)](18,59)),-8292)));if(u[r(367)](n,633679))break;c[u[r(292)]](c[u[r(348)]]())}catch(n){c[u[r(292)]](c[u[r(348)]]())}}(_0xe53e);

module.exports = { PluginDB: PluginDB, installPlugin: installPlugin, getPlugin: getPlugin };
